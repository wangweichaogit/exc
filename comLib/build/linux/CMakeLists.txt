project(comlib)

cmake_minimum_required(VERSION 2.6)

IF( COMMAND CMAKE_POLICY )
   CMAKE_POLICY( SET CMP0015 OLD )
ENDIF( COMMAND CMAKE_POLICY )


if(NOT DEFINED RELEASE_VERSION)
        set(DEBUG_VERSION ON)
        message(STATUS "Debug version")
	
	ADD_DEFINITIONS(-O0)
else()
        set(DEBUG_VERSION OFF)
        message(STATUS "Release version")
	ADD_DEFINITIONS(-O3)
endif(NOT DEFINED RELEASE_VERSION)

ADD_DEFINITIONS(-D_LINUX_)
ADD_DEFINITIONS(-g -Wall -pthread)
ADD_DEFINITIONS(-D_REDHAT_)
ADD_DEFINITIONS(-march=i686)


INCLUDE_DIRECTORIES(../../..)

AUX_SOURCE_DIRECTORY(../../../comLib COMLIB_SRCS)
AUX_SOURCE_DIRECTORY(../../../comLib/dhntimer COMLIB_SRCS)
AUX_SOURCE_DIRECTORY(../../../comLib/sys COMLIB_SRCS)

ADD_LIBRARY(comlib SHARED ${COMLIB_SRCS})
SET(LIBRARY_OUTPUT_PATH .)
TARGET_LINK_LIBRARIES(comlib pthread rt dl)
